<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì†Œë¹„ í‰ê°€ - ì²« í™”ë©´</title>
  <!-- ì´ íŒŒì¼ì€ firstswipe.cssë¥¼ ì‚¬ìš© -->
  <link rel="stylesheet" href="firstswipe.css">

  <!-- ğŸ”¹ ì´ í˜ì´ì§€ ì „ì²´ì— ì•„ë˜ìª½ ì—¬ë°± 48px ì¶”ê°€ -->
  <style>
    .page {
      padding-bottom: 48px !important;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- ì”¨ì•— ëŒ€ì‹  Lv4smile ìºë¦­í„° -->
    <img src="image/Lv4smile.png" alt="ìºë¦­í„°" class="mascot">

    <!-- ìºë¦­í„°ê°€ ë§í•˜ëŠ” ë§í’ì„  + íƒ€ì´í•‘ í…ìŠ¤íŠ¸ -->
    <div class="speech">
      <div class="speech-bubble">
        <p id="typing-text" class="typing-text"></p>
      </div>
    </div>

    <!-- ë‚ ì§œ (ì›í•˜ë©´ ë‚˜ì¤‘ì— ë™ì  ì²˜ë¦¬ ê°€ëŠ¥) -->
    <h3 class="date-title">2025ë…„ 11ì›” 1ì¼</h3>

    <!-- ì†Œë¹„ ë‚´ì—­ ë¦¬ìŠ¤íŠ¸ -->
    <div class="list" id="expense-list">
      <!-- JSì—ì„œ ë Œë”ë§ -->
    </div>

    <!-- ì—¬ëŸ¬ ê°œ ì„ íƒ í›„ ë„˜ì–´ê°€ëŠ” ë²„íŠ¼ -->
    <button class="evaluate-btn" id="evaluate-btn" type="button" disabled>
      ì„ íƒí•œ ì†Œë¹„ í‰ê°€í•˜ëŸ¬ ê°€ê¸°
    </button>
  </div>

  <script>
    // ---------- ê°€ìƒì˜ ì†Œë¹„ ë‚´ì—­ë“¤ ----------
    const expenses = [
      {
        id: 0,
        title: "ë©”ê°€ì»¤í”¼",
        amount: 3900,
        detail: "ë©”ê°€ì»¤í”¼ | ì¹´ì¹´ì˜¤ë±…í¬",
        icon: "image/mgc.png"
      },
      {
        id: 1,
        title: "ë©”ê°€ì»¤í”¼",
        amount: 4500,
        detail: "ì €ë… ì•„ë©”ë¦¬ì¹´ë…¸ | ì¹´ì¹´ì˜¤ë±…í¬",
        icon: "image/mgc.png"
      },
      {
        id: 2,
        title: "ë„·í”Œë¦­ìŠ¤",
        amount: 13500,
        detail: "ë„·í”Œë¦­ìŠ¤ | ì²´í¬ì¹´ë“œ",
        icon: "image/netflix.png"
      },
      {
        id: 3,
        title: "ë°°ë‹¬ì˜ ë¯¼ì¡±",
        amount: 22000,
        detail: "í˜í˜ë¡œë‹ˆ í”¼ì P ì„¸íŠ¸ | ì¹´ì¹´ì˜¤í˜ì´",
        icon: "image/bmin.png"
      },
      {
        id: 4,
        title: "ë°°ë‹¬ì˜ ë¯¼ì¡±",
        amount: 12000,
        detail: "ì•¼ì‹ ë–¡ë³¶ì´ ì„¸íŠ¸ | ì¹´ì¹´ì˜¤í˜ì´",
        icon: "image/bmin.png"
      },
      {
        id: 5,
        title: "ë©”ê°€ì»¤í”¼",
        amount: 2800,
        detail: "ë””ì¹´í˜ì¸ ë¼ë–¼ | ì¹´ì¹´ì˜¤ë±…í¬",
        icon: "image/mgc.png"
      },
      {
        id: 6,
        title: "ë„·í”Œë¦­ìŠ¤",
        amount: 9500,
        detail: "ë„·í”Œë¦­ìŠ¤ ëª¨ë°”ì¼ | ì²´í¬ì¹´ë“œ",
        icon: "image/netflix.png"
      }
    ];

    const listEl = document.getElementById("expense-list");
    const evaluateBtn = document.getElementById("evaluate-btn");

    const formatAmount = (n) =>
      "-" + n.toLocaleString("ko-KR", { maximumFractionDigits: 0 }) + "ì›";

    // âœ… ì„ íƒëœ indexë“¤ì„ ì €ì¥ (ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥)
    const selectedIndices = new Set();

    // ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
    expenses.forEach((item, index) => {
      const card = document.createElement("button");
      card.className = "item";
      card.type = "button";
      card.dataset.index = index;

      card.innerHTML = `
        <div class="item-left">
          <div class="item-icon">
            <img src="${item.icon}" alt="${item.title} ì•„ì´ì½˜">
          </div>
        </div>
        <div class="item-right">
          <div class="item-amount">${formatAmount(item.amount)}</div>
          <div class="item-detail">${item.detail}</div>
        </div>
      `;

      // í´ë¦­ ì‹œ ì„ íƒ/í•´ì œ í† ê¸€
      card.addEventListener("click", () => toggleSelect(card, index));

      listEl.appendChild(card);
    });

    function toggleSelect(card, index) {
      if (selectedIndices.has(index)) {
        // ì´ë¯¸ ì„ íƒë˜ì–´ ìˆìœ¼ë©´ í•´ì œ
        selectedIndices.delete(index);
        card.classList.remove("selected");
      } else {
        // ìƒˆë¡œ ì„ íƒ
        selectedIndices.add(index);
        card.classList.add("selected");
      }

      updateEvaluateButtonState();
    }

    // âœ… 3ê°œ ì´ìƒ ì„ íƒí–ˆì„ ë•Œë§Œ ë²„íŠ¼ í™œì„±í™”
    function updateEvaluateButtonState() {
      if (selectedIndices.size >= 3) {
        evaluateBtn.disabled = false;
        evaluateBtn.classList.add("enabled");
      } else {
        evaluateBtn.disabled = true;
        evaluateBtn.classList.remove("enabled");
      }
    }

    // âœ… 3ê°œ ë¯¸ë§Œì´ë©´ ë„˜ì–´ê°€ì§€ ëª»í•˜ê²Œ
    evaluateBtn.addEventListener("click", () => {
      if (selectedIndices.size < 3) return;

      const indicesArray = Array.from(selectedIndices);
      const first = indicesArray[0];
      const listParam = indicesArray.join(",");

      // í‰ê°€ í™”ë©´ìœ¼ë¡œ ì´ë™
      window.location.href = `firstchoose.html?item=${first}&list=${listParam}`;
     });

    // ---------- íƒ€ì´í•‘ íš¨ê³¼ ----------
    const typingTarget = document.getElementById("typing-text");
    const typingMessage =
      "ì•± ì‚¬ìš©ì„ í•˜ê¸° ì „, ì¬í˜¸ë‹˜ì˜ ìµœê·¼ ì†Œë¹„ ë‚´ì—­ 3ê°œ ì´ìƒì„ ì„ íƒí•´ì£¼ì„¸ìš”";
    let typingIndex = 0;

    function typeStep() {
      if (typingIndex <= typingMessage.length) {
        typingTarget.textContent = typingMessage.slice(0, typingIndex);
        typingIndex++;
        setTimeout(typeStep, 60); // ì†ë„ ì¡°ì ˆ
      }
    }

    typeStep();
  </script>
  <script src="characterManager.js"></script>
</body>
</html>
