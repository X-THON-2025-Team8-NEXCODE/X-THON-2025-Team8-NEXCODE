<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê°€ê³„ë¶€ ìºë¦­í„° ì•±</title>
  <link rel="stylesheet" href="style.css" />

  <!-- ğŸ”¹ í—¤ë”(ì•Œë¦¼/ë‚´ì •ë³´/ë”ë³´ê¸°) ì•„ë˜ë¡œ 48px ë‚´ë¦¬ê¸° - ë¬´ì¡°ê±´ ì ìš©ë˜ë„ë¡ !important -->
  <style>
    .app-header {
      margin-top: 48px !important;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- í—¤ë” -->
    <header class="app-header">
      <button class="icon-btn" aria-label="ì•Œë¦¼">
        <img src="image/alarm.png" alt="ì•Œë¦¼ ì•„ì´ì½˜" />
      </button>
      <button class="icon-btn" aria-label="ë§ˆì´í˜ì´ì§€">
        <img src="image/my.png" alt="ë§ˆì´í˜ì´ì§€ ì•„ì´ì½˜" />
      </button>
      <button class="icon-btn" aria-label="ë©”ë‰´">
        <img src="image/more.png" alt="ë©”ë‰´ ì•„ì´ì½˜" />
      </button>
    </header>

    <!-- ì˜¤ëŠ˜ì˜ ì§€ì¶œ -->
    <section class="today-section">
      <div class="today-card">
        <div class="today-label-row">
          <span class="today-label">ì¬í˜¸ë‹˜ì˜ ì˜¤ëŠ˜ì˜ ì§€ì¶œ</span>
          <button class="refresh-btn" id="refresh-btn" aria-label="ìƒˆë¡œê³ ì¹¨">
            <img
              src="image/f5.png"
              alt="ìƒˆë¡œê³ ì¹¨ ì•„ì´ì½˜"
              class="refresh-icon"
            />
          </button>
        </div>
        <div class="today-amount-text" id="today-amount">
          0ì›
        </div>
      </div>
    </section>

    <!-- ìºë¦­í„° ë ˆë²¨ & ì§„í–‰ë¥  ë§ -->
    <section class="mascot-section">
      <div class="progress-ring">
        <!-- SVG ì§„í–‰ë¥  ì› -->
        <svg width="260" height="260">
          <defs>
            <!-- ì§„í–‰ë¥  ìƒ‰ìƒ ê·¸ë¼ë°ì´ì…˜ -->
            <linearGradient id="grad-progress" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#b7ffcd" />
              <stop offset="45%" stop-color="#8ef7b3" />
              <stop offset="100%" stop-color="#5de39e" />
            </linearGradient>
          </defs>

          <!-- ë°°ê²½ ë§ -->
          <circle
            class="ring-bg"
            cx="130"
            cy="130"
            r="110"
          />

          <!-- ì±„ì›Œì§€ëŠ” ë§ -->
          <circle
            class="ring-progress"
            id="progress-circle"
            cx="130"
            cy="130"
            r="110"
          />
        </svg>

        <!-- ì•ˆìª½ ë™ê·¸ë¼ë¯¸ (ì”¨ì•— + ë ˆë²¨) -->
        <div class="progress-inner">
          <img src="image/seed.png" alt="ì €ê¸ˆ ìºë¦­í„°" class="mascot-img" />
          <div class="level-text" id="level-text">Lv. 1</div>
        </div>
      </div>
    </section>

    <!-- ê°€ê³„ë¶€ / í›„íšŒë„ / ì†Œë¹„ í‰ê°€ -->
    <section class="actions-card">
      <div class="actions-row">
        <button class="action-item">
          <img src="image/calendar.png" alt="ê°€ê³„ë¶€ ì•„ì´ì½˜" />
          <span class="action-label">ê°€ê³„ë¶€</span>
        </button>

        <button class="action-item">
          <img src="image/sad.png" alt="í›„íšŒë„ ì•„ì´ì½˜" />
          <span class="action-label">í›„íšŒë„</span>
        </button>

        <!-- ğŸ”¹ ì—¬ê¸°ë§Œ ìˆ˜ì •: id ì¶”ê°€í•´ì„œ swipe.htmlë¡œ ì´ë™ì‹œí‚¤ê¸° -->
        <button class="action-item" id="review-button">
          <img src="image/good.png" alt="ì†Œë¹„ í‰ê°€ ì•„ì´ì½˜" />
          <span class="action-label">ì†Œë¹„ í‰ê°€</span>
        </button>
      </div>
    </section>

    <!-- ì§€ì¶œ ë‚´ì—­ -->
    <section class="history-card">
      <div class="history-header">ì§€ì¶œ ë‚´ì—­</div>
      <div class="history-list" id="history-list"></div>
      <div class="history-more">ë” ë³´ê¸°</div>
    </section>
  </div>

  <script>
    // --------------------- ì§€ì¶œ ë‚´ì—­ ë”ë¯¸ ë°ì´í„° ---------------------
    const expenses = [
      {
        icon: "M",
        iconSrc: "image/mgc.png",      // ğŸ”¹ ë©”ê°€ì»¤í”¼ ì´ë¯¸ì§€
        title: "ë©”ê°€ì»¤í”¼",
        subtitle: "ë©”ê°€ì»¤í”¼ Â· ì¹´ì¹´ì˜¤ë±…í¬",
        tag: "ì¹´í˜",
        amount: 3900,
      },
      {
        icon: "N",
        iconSrc: "image/netflix.png",  // ğŸ”¹ ë„·í”Œë¦­ìŠ¤ ì´ë¯¸ì§€
        title: "ë„·í”Œë¦­ìŠ¤",
        subtitle: "ë„·í”Œë¦­ìŠ¤ Â· ì¹´ì¹´ì˜¤í˜ì´",
        tag: "êµ¬ë…",
        amount: 11700,
      },
      {
        icon: "B",
        iconSrc: "image/bmin.png",     // ğŸ”¹ ë°°ë¯¼ ì´ë¯¸ì§€
        title: "ë°°ë‹¬ì˜ ë¯¼ì¡±",
        subtitle: "í˜í˜ë¡œë‹ˆ í”¼ì P ì„¸íŠ¸",
        tag: "ë°°ë‹¬",
        amount: 14000,
      },
    ];

    const historyListEl = document.getElementById("history-list");
    const todayAmountEl = document.getElementById("today-amount");

    const formatCurrency = (n) =>
      n.toLocaleString("ko-KR", { maximumFractionDigits: 0 }) + "ì›";

    // ë Œë”ë§ + í•©ê³„ ê³„ì‚°
    let total = 0;
    expenses.forEach((item) => {
      total += item.amount;

      const row = document.createElement("div");
      row.className = "history-item";

      row.innerHTML = `
        <div class="history-left">
          <div class="history-icon">
            <img src="${item.iconSrc}" alt="${item.title} ì•„ì´ì½˜" />
          </div>
          <div class="history-text">
            <div class="history-title-row">
              <span class="history-merchant">${item.title}</span>
              <span class="history-tag">${item.tag}</span>
            </div>
            <div class="history-sub">${item.subtitle}</div>
          </div>
        </div>
        <div class="history-right">
          <span class="history-amount">-${formatCurrency(item.amount)}</span>
        </div>
      `;

      historyListEl.appendChild(row);
    });

    // ì˜¤ëŠ˜ì˜ ì§€ì¶œ = í•©ê³„
    todayAmountEl.textContent = formatCurrency(total);

    // --------------------- ì§„í–‰ë¥  ê²Œì´ì§€ (ì›í˜• ë§) ---------------------
    const circle = document.getElementById("progress-circle");
    const radius = circle.r.baseVal.value;
    const circumference = 2 * Math.PI * radius;

    circle.style.strokeDasharray = `${circumference}`;
    circle.style.strokeDashoffset = `${circumference}`;

    // ì˜ˆì‹œ: ì˜¤ëŠ˜ ì˜ˆì‚° 50,000ì› ê¸°ì¤€ìœ¼ë¡œ ì§„í–‰ë¥  ê³„ì‚°
    const DAILY_BUDGET = 50000;
    const progress = Math.max(
      0,
      Math.min(100, Math.round((total / DAILY_BUDGET) * 100))
    );

    function setProgress(percent) {
      const offset = circumference - (percent / 100) * circumference;
      circle.style.strokeDashoffset = offset;
    }

    // ì‚´ì§ ë”œë ˆì´ ë‘ê³  ì• ë‹ˆë©”ì´ì…˜
    setTimeout(() => setProgress(progress), 300);

    // --------------------- ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ ---------------------
    document
      .getElementById("refresh-btn")
      .addEventListener("click", () => location.reload());

    // ğŸ”¹ ì†Œë¹„ í‰ê°€ ë²„íŠ¼ â†’ swipe.html ì´ë™
    document
      .getElementById("review-button")
      .addEventListener("click", () => {
        window.location.href = "swipe.html";
      });
  </script>
</body>
</html>
